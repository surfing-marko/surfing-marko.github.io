<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Session Starter</title>
	<style>
	body
	{
		margin: 0;
		height: 100vh;
		display: flex;
		justify-content: center;
		align-items: center;
		font-family: Arial, sans-serif;
		background-color: #f0f0f0;
	}

	.start-btn
	{
		padding: 1rem 2rem;
		font-size: 1.2rem;
		background-color: #007bff;
		color: white;
		border: none;
		border-radius: 5px;
		cursor: pointer;
		transition: background-color 0.3s ease;
	}

	.start-btn:hover
	{
		background-color: #0056b3;
	}

	.popup-c,
	.popup-p
	{
		position: fixed;
		top: 0;
		left: 0;
		width: 100vw;
		height: 100vh;
		background: rgba(0, 0, 0, 0.6);
		display: flex;
		justify-content: center;
		align-items: center;
		visibility: hidden;
		opacity: 0;
		transition: opacity 0.3s ease, visibility 0.3s ease;
		z-index:999999999999999;
	}

	.popup-content
	{
	background-color: white;
	padding: 2rem;
	border-radius: 10px;
	box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
	text-align: center;
	width: 300px;
	}

	.popup-text
	{
	margin-bottom: 2rem;
	font-size: 1.2rem;
	}

	.popup-pin-code {
	margin-bottom: 2rem;
	font-size: 2rem;
	}

	.popup-buttons
	{
	display: flex;
	justify-content: space-around;
	}

	.popup-btn
	{
	padding: 0.8rem 1.5rem;
	font-size: 1rem;
	border: none;
	border-radius: 5px;
	cursor: pointer;
	transition: background-color 0.3s ease;
	}

	.cancel-btn
	{
	background-color: #dc3545;
	color: white;
	}

	.cancel-btn:hover
	{
	background-color: #c82333;
	}

	.continue-btn
	{
	background-color: #28a745;
	color: white;
	}

	.continue-btn:hover
	{
	background-color: #218838;
	}

	.show
	{
	visibility: visible;
	opacity: 1;
	}

	.pin-container {
		text-align: center;
	}
	
	.pin-code {
		font-size: 2.5rem;
		font-weight: bold;
		margin: 1rem 0;
	}
	
	.end-btn {
		padding: 1rem 2rem;
		font-size: 1.2rem;
		background-color: #dc3545;
		color: white;
		border: none;
		border-radius: 5px;
		cursor: pointer;
		transition: background-color 0.3s ease;
		margin-left: 1rem;
	}
	
	.end-btn:hover {
		background-color: #c82333;
	}
	</style>
</head>

<body>

	<!-- Pin Display -->
	<div class="pin-container">
		<h2>Your Session Pin:</h2>
		<p class="pin-code" id="pin-code">Waiting for session...</p>
		<button class="start-btn" onclick="startCorowsing()">Start Session</button>
		<button class="end-btn" onclick="endSession()">End Session</button>
	</div>

	<script>
	var SurflySession;
	function startCorowsing() {
		(function (s, u, r, f, l, y) {
			s[f] = s[f] || { init: function () { s[f].q = arguments } };
			l = u.createElement(r); y = u.getElementsByTagName(r)[0]; l.async = 1;
			l.src = 'https://surfly.com/surfly.js'; y.parentNode.insertBefore(l, y);
		})(window, document, 'script', 'Surfly');

		var settings = {
			widget_key: "4e3d97b9f9c549b798eb8735a4b7c619",
			block_until_agent_joins: false,
			session_autorestore_enabled: false
		};

		Surfly.init(settings, function (init) {
			if (init.success && !Surfly.isInsideSession) {
				console.log("init success");
				SurflySession = Surfly.session().startLeader()
				.on("session_created", function (session, event) {
					document.getElementById("pin-code").innerText = session.pin;
					console.log("session pin:" + session.pin);
				})
				.on("participant_joined", function (session, event) {
					console.log("participant joined");
					SurflySession.relocate("https://www.rbc.com", false);
				});
			}
		});
	}

	function endSession() {
		SurflySession.end();
		document.getElementById("pin-code").innerText = "Waiting for session...";
	}
	</script>
</body>

</html>